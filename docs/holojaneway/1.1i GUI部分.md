---
id: 1.1i
title: 1.1i GUI
description: T88使用文档-GUI
hide_table_of_contents: false

---

#  GUI

目前，T88的GUI部分主要特点是：仅客户端、非Inventory/Container、尽量贴近原版风格、带有一些Swing风格。



## 快速Q&A

- Q：我可以将原版或者第三方的GUI类转移到T88吗？
- A：可以。在大多数情况下，只需要实现`TWidget`接口即可。



- Q：我要如何新建自己的组件？
- A：继承`TPanel`即可。



- Q：开发时懒得写Input，有什么方便的办法快捷地可以在游戏中查看我写的Screen吗？
- A：在启动时指定property`t88.test_screen_override`的值为你所写的Screen的名称，进入游戏后按`ctrl+T`，T88会简单地使用`Class.forName`来查找你的Screen并尝试实例化一个（所以构造函数得是无参的），让MC显示它。

## 基础

在构造函数中使用`add(TWidget child)`方法以添加子组件。继承于`TWidget`的子组件会自动地被渲染（调用其`render`方法），不需要您在`render(PoseStack...)`中手动指出。

和Swing的`LayoutManager`类似（不过没有那么高级），在`layout()`方法中使用`setBounds(int x, int y, int width, int height)`对子组件以相对坐标设置位置和大小。

如果要使用tick方法，请使用`tickT()`方法。T88中与原版重名的方法均在后面加`T`。

请注意，在正常情况下，重写`layout()`、`tickT()`、`render(PoseStack...)`之后，你都应该在方法末尾调用超类的相应方法。即

```java
@Override
void layout() {
child.setBounds...
...
super.layout();
}
```



## 结构图

这是一张T88的GUI类结构图,在新标签页打开以放大查看。不保证即时性和完整性。

![image](https://user-images.githubusercontent.com/57312492/195476649-0265719a-4417-435c-888c-7d4d69c3b092.png)

## 基础设施

### TWidget

`TWidget`是整个T88的基础，一切组件都实现此接口。

:::info

由于重名的缘故，对变量`visible`的getter和setter为`isVisibleT()`和`setVisibleT(boolean visible)`。

:::

```java
boolean isVisibleT()
void setVisibleT(boolean visible)
```

检查/设置组件是否可见。注意此可见性会影响组件的交互性。但不会影响被tick。

```java
void setBounds(int x, int y, int width, int height)
```

指定组件的位置和大小。使用相对位置，即`(0,0)`表示父类的最左上角。

```java
void setAbsBounds(int x, int y, int width, int height)
```

指定组件的位置和大小。使用绝对位置，即`(0,0)`表示窗口（Screen）的最左上角。

```java
Vec2i getPreferredSize()
```

返回组件自我建议的大小。以按钮为例，其返回`(52,20)`表示一个长度为52，但高度为20的黄金比例大小。

没有指定建议的大小时应返回当前大小。

:::caution

组件刚被构造出来时，当前的大小会是`(0,0)`。调用没有被复写的`getPreferredSize`可能会使组件行为不符合预期。

:::

```java
Vector2i getSize();
```

获取当前大小。

```java
@Nullable
TComponent getParent()
```

获取父组件。

```java
void setParentScreen(@Nullable TScreen parentScreen)
@Nullable
TScreen getParentScreen()
```

获取父Screen。仅当是Screen的直接子组件时有效。

```java
@Nullable TScreen getTopParentScreen()
```

获取父Screen。是间接子组件时也有效。

```java
int getXT()
int getYT()
```

获取组件左上角位置。坐标原点为窗口最左上角。

```java
void renderTop(GuiGraphics graphics, int pMouseX, int pMouseY, float pPartialTick)
```

用于在一次Screen及子组件正常渲染完成之后再进行渲染。

```java
boolean isInRange(double pMouseX, double pMouseY, double xPadding, double yPadding)
```

判断输入的鼠标位置是否在本组件的范围内。padding为向外延伸的容差值。

```java
void onFinalClose()
```

在Screen关闭时调用，可以用于取消注册等。

```java
@Nullable <T extends TWidgetT getParentInstanceOf(Class<T> c)
```

返回指定类型的父组件。若找不到则返回`null`。

```java
double getParentScrollAmountIfExist()
```

返回父滚动面板（`TScrollPanel`）的滚动值。若无父滚动面板则返回0。

此返回值在向上滚动（向下滚滚轮）时为正，故若要将此用于鼠标判定修正，则取此数；若要用于渲染修正，则取相反数。

```java
boolean isOutOfParentScrollContainerScissor()
```

判断是否在父滚动容器的显示范围之外。

---

### TComponent

`TComponent`是`GuiComponent`和`TWidget`的基本实现。

```java
void add(TWidget child)
void remove(TWidget tWidget)
```

将组件添加到子组件表（或移除）。使得在本组件的`layout()`、`tickT()`、`render(PoseStack...)`等方法执行完成之后，子组件的对应方法将被相应地调用。

```java
void setBorder(Border border)
Border(int color, int thickness)
```

设置一个边界框。通常用于开发环境调试。

以`0xAARRGGBB`格式指定边界框的颜色，指定边界框的厚度，正数为外边框，负数为内边界框。。

```java
void setBackground(int background)
```

以`0xAARRGGBB`格式指定背景颜色。

```java
void setForeground(int foreground)
```

以`0xaarrggbb`格式指定前景颜色。前景颜色在此处并无实际作用。

```java
void resizeAsHud(int screenWidth, int screenHeight)
```

作为HUD根面板时，更改窗口大小时被调用。

```java
boolean isShowHudEvenLoggedOut()
void setShowHudEvenLoggedOut(boolean showHudEvenLoggedOut)
```

作为HUD根面板时，是否在玩家退出世界时关闭。默认在玩家退出世界时关闭。

```java
static void blitById(GuiGraphics graphics, int id, int x, int y, int width, int height, float uOffset, float vOffset, int uWidth, int vHeight, int textureWidth, int textureHeight)
static void blitById(GuiGraphics graphics, int id, int x0, int x1, int y0, int y1, int z, int uWidth, int vHeight, float uOffset, float vOffset, int textureWidth, int textureHeight)
```

使用id而不是`ResourceLocation`绘制指定图片。用于绘制`DynamicTexture`等。

```java
void drawStringSingleLine(GuiGraphics graphics, Font font, Component text, float fontSize, HorizontalAlignment align, int minX, int maxX, int minY, int maxYOnlyForScissor, int color)
...
static void drawStringSingleLine(TWidget thiz, GuiGraphics graphics, Font font, Component text, float fontSize, HorizontalAlignment align, int minX, int maxX, int minY, int maxYOnlyForScissor, int color)
```

绘制文字，超出指定宽度时自动启用滚动。

---

### HudManager

```java
static void add(TComponent... tComponents)
static void remove(TComponent... tComponents)
```

添加/移除HUD组件。

```java
static LinkedHashSet<TComponent> getChildren()
```

获取所有现存的组件。

---

## 基础组件

### TPanel

`TComponent`的封装。目前没有特别的功能。通常作为一个组件容器使用。



### TScrollPanel

支持滚动以在纵向容纳更多内容的`TPanel`。不支持横向滚动。

为子组件指定位置时正常填写即可（即使数值超出了屏幕大小），滚动条会自动地被启用。

```java
int getUsableWidth()
```

返回可用宽度。当您在为子组件进行布局时应使用此方法，而不是`this.getWidth()`。



```java
double getScrollAmount()
```

获取滚动值。向上滚动（向下滚滚轮）时为正。



```java
void addScrollAmount(double deltaScroll)
```

指定滚动增量。向上滚动（向下滚滚轮）时为负。



```java
int getScrollbarGap()
void setScrollbarGap(int scrollbarGap)
```

返回（指定）滚动条与可用区域的间隙大小。默认为0。



### TLabel

用于显示一行文字。

```java
TLabel(Component s, int foreground)
```

指定要显示的文本，以`0xaarrggbb`格式指定文本的颜色。



```java
void setHorizontalAlignment(HorizontalAlignment horizontalAlignment)
```

设置文本的对齐方式。提供左对齐、居中和右对齐。



```java
void setFontSize(int size)
```

指定文本大小。默认大小为7。



### TTitledComponent\<T extends TWidget\>

这是一个组合组件，用于给某个组件添加一个标题。

提供的实现有`TTitledButton`、`TTitledCycleButton<E`、`TTitledEditBox`、`TTitledSelectList<E`、`TTitledSimpleConstrainedEditBox`、`TTitledSuggestedEditBox`。

子组件的位置在`defaultLayout()`中被自动地设置。若要手动指定其位置，请重写`defaultLayout()`（而不是`layout()`），不需要在最后调用超类的此方法。

标题默认为左对齐。

就像这句话相对于下面这个引用框一样。

```java
int getGap()
void setGap(int gap)
```

返回（指定）标题与组件的间隙大小。默认为0。



```java
int getLabelHeight()
void setLabelHeight(int labelHeight)
```

返回（指定）标题的高度。默认为12。



### TSlider

滑动条。原版`SliderButton`的T88封装。

实现了接口`TResponder<T`标志着这个类有响应器。其中的T通常是组件自己或自己的值，在此处是滑动条的浮点数值。

```java
TSlider(double pMinValue, double pMaxValue, float pSteps, Component tipText)
```

指定最小值，指定最大值，指定步进，指定要显示的文本。

由于缩放的关系，步进通常不起实际意义，只需要填入一个较小的值。如当范围为0-1时，填入0.01即可。



```java
void setValue(double value)
double getValue()
```

指定（返回）滑动条的值。响应器会在指定值后被触发。

```java
void setValueWithoutRespond(double value)
```

在不触发响应器的情况下指定滑动条的值。适用于滑动条和其他组件相互进行更改的情况，避免无限相互调用。



### TButton

按钮。原版Button的T88封装。

```java
TButton(Component pMessage, OnPress pOnPress, OnTooltip pOnTooltip)
```

指定按钮上要显示的文本，指定被按下时的动作，`pOnTooltip`暂时不起实际作用。



### TCycleButton\<E\>

循环式按钮，在可选元素中循环切换。继承于`TButton`，而非继承于原版`CycleButton`。

可选元素是内部类`Entry`，含有实际内容`E content`和响应器`Consumer<TCycleButton<EonSwitched`。

建议泛型`E`实现接口`ToTranslatableString`，以指定语言文件中的键值。未实现的E将直接调用`toString()`。

```java
void addElement(E e)
```

添加可选元素。



```java
void removeElement(E e)
```

移除可选元素。

`Entry`的`equals`方法经过重写，以实际内容`E content`为准，而不论响应器的内容。



```java
int getSelectedIndex()
```

返回当前被选中的元素序号。



```java
LinkedList<EntrygetValues()
```

返回所有可选元素。



```java
@Nullable Entry getSelected()
```

返回被选中的元素。当无可选元素是返回`null`。



```java
void select(int index) throws IndexOutOfBoundsException
```

指定选中对应序号的元素。

被选中的元素会触发其响应器`Consumer<TCycleButton<EonSwitched`。

发出事件`TWidgetContentUpdatedEvent`。



```java
void select(E content)
```

指定选中含有填入内容的元素。



### TSelectList\<E\>

选择表，原版`ObjectSelectionList<E extends ObjectSelectionList.Entry<E`的T88封装。

可选元素是内部类`Entry`，含有实际内容`E content`和响应器`Consumer<TSelectList<EonSwitched`，以及可以单独指定的前景色`Integer specialForeground`。

建议泛型`E`实现接口`ToTranslatableString`，以指定语言文件中的键值。未实现的将直接调用`toString()`。

```java
TSelectList(int pItemHeight, int scrollbarGap)
```

指定每栏的高度，指定主要区域和滚动条的间隙大小。



对可选元素的操作与`TCycleButton<E`类似。

被选中的元素会触发其响应器`Consumer<TSelectList<EonSwitched`。

但不会发出事件`TWidgetContentUpdatedEvent`。



```java
void setHorizontalAlignment(HorizontalAlignment horizontalAlignment)
```

指定元素显示文字的对齐方式。默认是居中。



### TEditBox

输入框，原版`EditBox`的T88封装。实现了接口`TResponder<String`。

在被聚焦时发出事件`EditBoxFocusedEvent`，由其他输入框接受并取消自己的聚焦状态。防止多个输入框同时显示为聚焦状态。

在输入内容时发出事件`TWidgetContentUpdatedEvent`。

```java
TEditBox(Component tipText)
```

不起实际作用。



```java
@Override
void setEditable(boolean pEnabled)
```

指定是否可以被编辑。若指定为不可编辑时没有输入内容，则显示`不可用`。



```java
boolean isEditable()
```

返回是否可以被编辑。是对Mixin类`AccessorProxy`中对应方法的方便封装。



### TImage

展示一张图片。构造函数中填入图片路径即可。

```java
void setImageFit(ImageFit imageFit)
```

指定图片展示时的契合方式。提供`FILL`填充、`FIT`适应、`STRETCH`拉伸和`TILE`平铺。参考桌面壁纸设置方式。默认为`FILL`填充。



```java
void setScale(float scale)
```

指定图片的大小缩放。仅推荐在`TILE`模式下使用。默认值为1。

这是GUI介绍页面的第二篇，简述一些稍复杂的组件。



以下是三种更高级的输入框。

### TSimpleConstrainedEditBox

特殊的`TEditBox`，允许简单地限定输入内容。


```java
TSimpleConstrainedEditBox(ArgumentType<?argument)
```

填入所需`ArgumentType`的实现即限定允许输入的内容。在检测到非法输入时，输入框内的文字将变为红色。



### TCommandConstrainedEditBox

借用原版指令系统来进行更高级的判断。

```java
TCommandConstrainedEditBox(Consumer<CommandDispatcher<CommandSourceStackconsumer)
```

填入一个`Consumer`，像编写原版指令那样对`CommandDispatcher<CommandSourceStack`进行任何你想要的处理。

未经完整测试。不保证实现`Commands`的所有功能。



### TSuggestedEditBox

在限定输入上与`TCommandConstrainedEditBox`相同，额外地在输入时提供一个候选菜单。使用键盘的`↑`和`↓`移动选择框，`tab`填入选中项。
