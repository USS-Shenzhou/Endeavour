---
id: config
title: Performance and Config
hide_table_of_contents: false

---

# 性能与配置

大量粒子的加入可能会使你原本熟悉的情况发生剧烈的变化。

---

## 最大粒子生成距离

这是一个隐藏设定项。

在原版设定下，`alwaysRender`为`false`的粒子如果距离摄像机超过32格，则不会被真正加入世界中。MadParticle将此值自动地改为了你的视距**值**的4倍，即如果你的视距设置为8（区块），则最大粒子生成距离为32（格）；如果你的视距是32，则最大粒子生成距离为128。

## 单队列最大粒子数量

在原版设定下，每种`RenderType`各自的粒子数量最大为16384，而我们通常只使用`PARTICLE_SHEET_TRANSLUCENT`一种，也就是世界内粒子最大数量相当于16384。在硬件性能更好的电脑上，16384个粒子可能并不会使FPS降低到令人无法接受的程度。MadParticle允许你在一定范围内自由调整此值。

在Forge版本上，你可以在Designer GUI的`设置`界面中调整这个值，滑块的数值范围是8192~131072。如果你需要超出这个范围的值，你可以到到`.minecraft/config/MadParticleConfig.json`中手动修改。

:::caution

MadParticle的设计场景是线上多人展会或类似场景，在这种情况下，由于各个玩家硬件状况不同，我们建议将粒子总数控制在8000以内。大量粒子的场景虽然在技术上被允许，但对其的优化并不是目前工作的首要任务。

:::

:::info

- 粒子数量与帧数的关系并不只取决于GPU性能。当需要频繁或在短时间内产生、运算和消失大量粒子时，CPU（可能还有内存）会成为帧数瓶颈。
    - 当粒子数量相当大时，粒子额外物理运算的多寡会有显著的影响。你可以把`方块碰撞`和`玩家互动`都设为`否`来降低这种影响；
    - 延长粒子寿命以在粒子总数相同的情况下尽可能地减少单位时间内生成/消失的粒子数量。在极端情况下，没有粒子生成/消失，与每tick都有成百上千个粒子生成/消失，可能会有数倍乃至数十倍的帧数差异。
    - Shimmer、Optifine、Sodium等渲染相关的模组也可能对帧数有显著的影响。

作为粗略参考：原版环境、粒子生成/消失较为频繁、无额外物理运算、Ryzen 5800x，1050Ti在有约10000个粒子时帧数会下降到24帧以下；3060Ti在有约40000个粒子时帧数会下降到24帧以下。若没有粒子生成/消失，3060Ti在有约100000个粒子时仍有约20帧。

**值得注意的是，在上述诸多因素影响下，极大量粒子场景下的性能表现可能很难具有时间上的可重复性，**即同一场景的性能表现可能会在多次测试时有明显差异。

:::
